# Visual Layer Dataset Cleaning Workflow

## Overview Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DATASET CLEANING WORKFLOW                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ImageNet1K   â”‚
â”‚  Raw Dataset  â”‚
â”‚  (1.28M imgs) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: Visual Layer Analysis (4-8 hours, automated)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Upload to VL platform                                      â”‚
â”‚  2. Run automated detection:                                   â”‚
â”‚     â€¢ Mislabel detection                                       â”‚
â”‚     â€¢ Outlier detection                                        â”‚
â”‚     â€¢ Duplicate detection                                      â”‚
â”‚     â€¢ Quality assessment                                       â”‚
â”‚  3. Export flagged samples                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ VL Export CSV â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: User Tagging (2-4 hours, manual)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Script: vl_tagging_workflow.py                                â”‚
â”‚                                                                 â”‚
â”‚  1. Load VL export                                             â”‚
â”‚  2. Create standardized manifest                               â”‚
â”‚  3. Generate HTML review interface                             â”‚
â”‚  4. Manual review:                                             â”‚
â”‚     â€¢ Validate VL findings                                     â”‚
â”‚     â€¢ Add user tags                                            â”‚
â”‚     â€¢ Decide actions (keep/remove/relabel)                     â”‚
â”‚  5. Cross-validate with team                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Tagged Manifest   â”‚
        â”‚ (user validated)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                 â”‚
                â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3A: Leak        â”‚  â”‚ PHASE 3B: Continue Tagging          â”‚
â”‚ Detection (2-12 hrs)  â”‚  â”‚ (if needed)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Script:               â”‚
â”‚ train_test_leak_      â”‚
â”‚ detection.py          â”‚
â”‚                       â”‚
â”‚ Methods:              â”‚
â”‚ 1. MD5 hash (exact)   â”‚
â”‚ 2. pHash (perceptual) â”‚
â”‚ 3. ResNet50 features  â”‚
â”‚                       â”‚
â”‚ Output:               â”‚
â”‚ â€¢ Leak report CSV     â”‚
â”‚ â€¢ Similarity scores   â”‚
â”‚ â€¢ Statistics          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Leaks Report  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚ PHASE 4: Merge &      â”‚         â”‚
â”‚ Finalize (1 hour)     â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â”‚ 1. Merge tagged       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    manifest + leaks   â”‚
â”‚ 2. Resolve conflicts  â”‚
â”‚ 3. Generate stats     â”‚
â”‚ 4. Create artifacts:  â”‚
â”‚    â€¢ Removal list     â”‚
â”‚    â€¢ Relabel map      â”‚
â”‚    â€¢ Summary report   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DELIVERABLES                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ imagenet1k_final_cleaning_manifest.csv                      â”‚
â”‚ â€¢ imagenet1k_removal_list.txt                                 â”‚
â”‚ â€¢ imagenet1k_relabel_map.json                                 â”‚
â”‚ â€¢ imagenet1k_cleaning_summary.txt                             â”‚
â”‚ â€¢ Presentation slides                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 5: Retrain on Cleaned Data                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Use CleanedImageNetDataset class                             â”‚
â”‚ â€¢ Apply removal list and relabel map                           â”‚
â”‚ â€¢ Train ResNet-18 with same config                             â”‚
â”‚ â€¢ Compare results to previous experiments                      â”‚
â”‚ â€¢ Document improvement in accuracy                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Parallel Workflow (Kushagra + Saeed)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   KUSHAGRA'S PATH   â”‚          â”‚    SAEED'S PATH     â”‚
â”‚   (ImageNet1K)      â”‚          â”‚      (COCO)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                â”‚
           â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ â”‚
           â–¼ â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Upload to VL â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ â° 4-8 hours (automated)
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Export from  â”‚
    â”‚     VL       â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                  â”‚                   â”‚
           â–¼                  â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Tagging    â”‚    â”‚  Tagging    â”‚    â”‚Cross-Review â”‚
    â”‚ (Kushagra)  â”‚    â”‚  (Saeed)    â”‚    â”‚   Together  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚                  â”‚                   â”‚
           â”‚ â° 2-4 hours     â”‚ â° 2-4 hours     â”‚
           â”‚                  â”‚                   â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Leak Detection   â”‚
                    â”‚   (Parallel)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ â° 2-12 hours (automated)
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Combine Results  â”‚
                    â”‚   & Document     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Decision Tree for User Tagging

```
VL Flags Sample
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Issue Type?     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â†’ Mislabel â”€â†’ High Conf? â”€â†’ YES â”€â†’ Verify â”€â†’ Confirm? â”€â†’ YES â”€â†’ relabel
     â”‚                  â”‚                    â”‚
     â”‚                  â”‚                    â””â”€â”€â†’ NO â”€â†’ mislabel_uncertain
     â”‚                  â”‚
     â”‚                  â””â”€â”€â†’ NO â”€â†’ Manual Review â”€â†’ Tag accordingly
     â”‚
     â”œâ”€â†’ Outlier â”€â”€â†’ Check Label â”€â†’ Correct? â”€â†’ YES â”€â†’ outlier_valid â†’ keep
     â”‚                                 â”‚
     â”‚                                 â””â”€â”€â†’ NO â”€â†’ outlier_invalid â†’ remove
     â”‚
     â”œâ”€â†’ Duplicate â”€â†’ Exact Match? â”€â†’ YES â”€â†’ duplicate_exact â†’ remove
     â”‚                   â”‚
     â”‚                   â””â”€â”€â†’ NO â”€â†’ Near Match? â”€â†’ YES â”€â†’ duplicate_near â†’ remove
     â”‚                                â”‚
     â”‚                                â””â”€â”€â†’ NO â”€â†’ Review manually
     â”‚
     â””â”€â†’ Quality â”€â”€â”€â†’ Unusable? â”€â†’ YES â”€â†’ low_quality_corrupt â†’ remove
                        â”‚
                        â””â”€â”€â†’ NO â”€â†’ Just Blur? â”€â†’ YES â”€â†’ low_quality_blur â†’ decide
                                                             â”‚
                                                             â””â”€â”€â†’ keep or remove
```

## File Flow Diagram

```
manifests/
â”‚
â”œâ”€ INPUT FILES
â”‚  â””â”€ imagenet1k_vl_export.csv â”€â”€â”€â”€â”
â”‚                                   â”‚
â”œâ”€ PROCESSING                       â”‚
â”‚  â”œâ”€ imagenet1k_tagged_v1.csv â—„â”€â”€â”€â”¤
â”‚  â”œâ”€ imagenet1k_tagged_v2.csv     â”‚
â”‚  â””â”€ imagenet1k_leaks_report.csv â”€â”¤
â”‚                                   â”‚
â”œâ”€ OUTPUT FILES                     â”‚
â”‚  â”œâ”€ imagenet1k_final_cleaning_manifest.csv â—„â”€â”¤
â”‚  â”œâ”€ imagenet1k_removal_list.txt               â”‚
â”‚  â”œâ”€ imagenet1k_relabel_map.json               â”‚
â”‚  â””â”€ imagenet1k_cleaning_summary.txt â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â””â”€ ARCHIVE (for reference)
   â””â”€ old versions...
```

## Timeline Gantt Chart

```
Day 1
â”œâ”€ Morning:   Setup VL, upload datasets
â”œâ”€ Afternoon: VL analysis running (automated)
â””â”€ Evening:   Check VL progress, export if done

Day 2
â”œâ”€ Morning:   Export VL results, run tagging workflow
â”œâ”€ Afternoon: Manual review and tagging
â”œâ”€ Evening:   Start leak detection (overnight)
â””â”€ Night:     Leak detection running (automated)

Day 3
â”œâ”€ Morning:   Review leak results, merge manifests
â”œâ”€ Afternoon: Finalize cleaning artifacts, docs
â””â”€ Evening:   Upload to Drive, prepare presentation

Day 4 (if needed)
â””â”€ Buffer for: Extended review, team coordination
```

## Data Flow Summary

```
Raw ImageNet1K (1.28M)
    â”‚
    â”œâ”€â†’ Visual Layer â”€â†’ Flagged (~100K-200K?)
    â”‚                      â”‚
    â”‚                      â””â”€â†’ User Tags â”€â†’ Confirmed Issues (~50K?)
    â”‚                                          â”‚
    â”‚                                          â”œâ”€â†’ Remove (~30K?)
    â”‚                                          â”œâ”€â†’ Relabel (~15K?)
    â”‚                                          â””â”€â†’ Keep (~5K?)
    â”‚
    â””â”€â†’ Leak Detection â”€â†’ Train-Test Duplicates (~1K-5K?)
                             â”‚
                             â””â”€â†’ Remove from Test
                                    â”‚
                                    â–¼
                        Cleaned Dataset (~1.25M train, 50K val)
                                    â”‚
                                    â–¼
                            Retrain ResNet-18
                                    â”‚
                                    â–¼
                        Improved Accuracy ğŸ“ˆ
```

## Success Metrics

```
BEFORE Cleaning:
â”œâ”€ Train: 1,281,167 images
â”œâ”€ Val:      50,000 images
â”œâ”€ Known issues: Unknown
â””â”€ Test accuracy: Baseline

AFTER Cleaning:
â”œâ”€ Train: ~1,250,000 images (-2.4%)
â”œâ”€ Val:      ~49,000 images (-2.0%)
â”œâ”€ Documented issues:
â”‚  â”œâ”€ Mislabels found: X
â”‚  â”œâ”€ Outliers found: Y
â”‚  â”œâ”€ Duplicates removed: Z
â”‚  â””â”€ Quality issues: W
â””â”€ Test accuracy: Baseline + A% ğŸ“ˆ

RESEARCH CONTRIBUTION:
â”œâ”€ Quantified data quality issues
â”œâ”€ Documented cleaning methodology
â”œâ”€ Measured impact on model performance
â””â”€ Reproducible pipeline for future work
```
